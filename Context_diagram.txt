@startuml
!include <C4/C4_Container>
title Уровень контекста

Person(U, "Клиент", "Клиент службы доставки")
Person(M, "Менеджер", "Менеджер службы доставки")
Person(O, "Курьер", "Курьер службы доставки")

System(IS, "Delivery Service", "PG on Hasura\nFlask on Colab")

System_Ext(YF, "Yandex Forms", " Клиент для отправки данных")
System_Ext(US, "Внешняя система email-уведомлений", "Unisender")
System_Ext(TG, "Внешняя система TG-уведомлений", "Telegram")
System_Ext(B, "Внешний шлюз онлайн-оплаты", "Redis + CloudAMQP")
System_Ext(YD, "Yandex DataLens", "BI-система")

Rel(U, YF, "Создать заявку на доставку заказа")
Rel(YF, IS, "Создать заявку на доставку заказа")
Rel(U, YF, "Оплатить доставку заказа")
Rel(YF, B, "Оплатить доставку заказа")
Rel(B,IS, "Оплатить доставку заказа")
Rel(U, YF, "Отслеживать статус заказа")
Rel(YF, IS, "Отслеживать статус заказа")
Rel(IS, US, "Отслеживать статус заказа")
Rel(US, U, "Отслеживать статус заказа")
Rel(M, IS, "Просмотреть заявки на доставку")
Rel(IS, US, "Отправить уведомление о новой заявке")
Rel(IS, TG, "Отправить уведомление о новой заявке")
Rel(US, M, "Отправить уведомление о новой заявке")
Rel(TG, M,  "Отправить уведомление о новой заявке")
Rel(M, IS, "Изменить статус заявки по доставке")
Rel(IS, TG, "Отправить уведомление о завершении доставки")
Rel(IS, US, "Отправить уведомление о завершении доставки")
Rel(TG, U, "Отправить уведомление о завершении доставки")
Rel(US, U, "Отправить уведомление о завершении доставки")
Rel(M, YD, "Анализировать статистику по клиентам, доставкам, платежам")
Rel(YD, IS, "Получить данные по клиентам, доставкам, платежам")
Rel(O, IS, "Принимать заявки на доставку")
Rel(O, IS, "Просматривать каталог заявок")
Rel(O, IS, "Просматривать отдельно взятую заявку")
Rel(M, IS, "Просматривать отдельно взятую заявку")
Rel(O, IS, "Просматривать доставки, характеристики по доставке")
Rel(M, IS, "Просматривать доставки, характеристики по доставке")

SHOW_LEGEND()